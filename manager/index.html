<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>RPG DREAM MANAGER</title>
<style>
:root{
  --bg:#0b0718; --panel:#16102a; --panel2:#120b22;
  --primary:#7b5cff; --primaryDark:#5a3fe0;
  --danger:#d4576b;
  --text:#efeaff; --muted:#b7b0e6; --stroke:#3a2b7a;
}
*{box-sizing:border-box}
body{margin:0;font-family:system-ui,-apple-system,BlinkMacSystemFont,sans-serif;background:var(--bg);color:var(--text)}
.container{max-width:420px;margin:auto;padding:24px}
h1,h2{margin:0 0 16px;text-align:center;letter-spacing:2px}
.btn{width:100%;padding:14px;margin:0 0 10px;font-size:15px;border:none;border-radius:12px;background:var(--primary);color:#fff}
.btn.secondary{background:transparent;border:1px solid var(--primary)}
.btn.danger{background:transparent;border:1px solid var(--danger);color:var(--danger)}
.card{background:var(--panel);padding:14px;border-radius:14px;margin-bottom:12px}
.meta{font-size:13px;color:var(--muted);margin-top:4px}
.row{display:flex;gap:8px;margin-top:10px}
.row .btn{margin:0;padding:10px;font-size:13px}
.hidden{display:none!important}
.backdrop{position:fixed;inset:0;background:rgba(0,0,0,.55);display:flex;align-items:center;justify-content:center;padding:18px}
.modal{width:min(420px,100%);background:var(--panel2);border:1px solid var(--stroke);border-radius:18px;padding:16px}
input,select{width:100%;padding:12px;border-radius:10px;border:1px solid var(--stroke);background:#120b22;color:var(--text);margin-bottom:12px}
label{display:block;margin-bottom:6px;color:var(--muted)}
.small{font-size:13px;color:var(--muted);text-align:center;margin-bottom:10px}
</style>
</head>
<body>

<div class="container">
  <h1>RPG DREAM MANAGER</h1>
  <button class="btn" onclick="openNew()">New Project</button>
  <button class="btn secondary" onclick="openLoad()">Load From Local Storage</button>
</div>

<!-- Load Modal -->
<div class="backdrop hidden" id="loadModal">
  <div class="modal">
    <h2>Local Projects</h2>
    <div id="projectList"></div>
    <button class="btn secondary" onclick="closeLoad()">Close</button>
  </div>
</div>

<!-- Rename Modal -->
<div class="backdrop hidden" id="renameModal">
  <div class="modal">
    <h2>Rename Project</h2>
    <input id="renameInput"/>
    <button class="btn" onclick="confirmRename()">Save</button>
    <button class="btn secondary" onclick="closeRename()">Cancel</button>
  </div>
</div>

<!-- New Project Modal -->
<div class="backdrop hidden" id="newModal">
  <div class="modal">
    <h2>New Project</h2>

    <label>Project Name</label>
    <input id="projectName"/>

    <label>View Type</label>
    <select id="view">
      <option value="topdown">Top View</option>
      <option value="angular">Angular View</option>
    </select>

    <label>Grid Preset</label>
    <select id="grid">
      <option value="small">Small Grid</option>
      <option value="medium">Medium Grid</option>
      <option value="large">Large Grid</option>
    </select>

    <label>Tile Size</label>
    <select id="tile">
      <option value="16">16 px</option>
      <option value="32" selected>32 px</option>
      <option value="48">48 px</option>
      <option value="64">64 px</option>
      <option value="96">96 px</option>
      <option value="128">128 px</option>
    </select>

    <button class="btn" onclick="createProject()">Create</button>
    <button class="btn secondary" onclick="closeNew()">Back</button>
  </div>
</div>

<script>
let renameTargetId = null;

function getProjects(){return JSON.parse(localStorage.getItem("rpgdream_projects")||"[]")}
function saveProjects(p){localStorage.setItem("rpgdream_projects",JSON.stringify(p))}

function openEditor(p){
  localStorage.setItem("rpgdream_last_opened",JSON.stringify(p));
  alert("Continue to Editor:\n"+p.name);
}

function renderProjects(){
  const list=document.getElementById("projectList");
  const projects=getProjects();
  list.innerHTML="";
  if(!projects.length){
    list.innerHTML="<div class='small'>No projects found.</div>";
    return;
  }
  projects.forEach(p=>{
    const card=document.createElement("div");
    card.className="card";
    card.innerHTML=`<strong>${p.name}</strong><div class="meta">${p.view} • ${p.tile}px • ${p.grid}</div>`;
    const row=document.createElement("div");
    row.className="row";
    row.innerHTML=`
      <button class="btn" onclick='openEditor(${JSON.stringify(p)})'>Continue</button>
      <button class="btn secondary" onclick='openRename("${p.id}","${p.name}")'>Rename</button>
      <button class="btn danger" onclick='deleteProject("${p.id}")'>Delete</button>
    `;
    card.appendChild(row);
    list.appendChild(card);
  });
}

function deleteProject(id){
  if(!confirm("Delete this project?"))return;
  saveProjects(getProjects().filter(p=>p.id!==id));
  renderProjects();
}

function openRename(id,name){
  renameTargetId=id;
  renameInput.value=name;
  renameModal.classList.remove("hidden");
}
function closeRename(){renameTargetId=null;renameModal.classList.add("hidden")}
function confirmRename(){
  const val=renameInput.value.trim();
  if(!val)return;
  const projects=getProjects();
  const p=projects.find(p=>p.id===renameTargetId);
  if(p)p.name=val;
  saveProjects(projects);
  closeRename();
  renderProjects();
}

function openLoad(){renderProjects();loadModal.classList.remove("hidden")}
function closeLoad(){loadModal.classList.add("hidden")}
function openNew(){newModal.classList.remove("hidden")}
function closeNew(){newModal.classList.add("hidden")}

function createProject(){
  const name=projectName.value.trim();
  if(!name)return alert("Project name required");
  const project={
    id:"proj_"+Date.now(),
    name,
    view:view.value,
    grid:grid.value,
    tile:tile.value
  };
  const projects=getProjects();
  projects.unshift(project);
  saveProjects(projects);
  closeNew();
}
</script>

</body>
</html>
